<!DOCTYPE html>
<html>
<head>
    <title>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ñ–µ</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h1>
    <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{ username }}</p>
    
    <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞</h2>
    {% if current_chat_info %}
        <div style="background: #e8f5e8; padding: 15px; margin: 10px 0; border-left: 4px solid #28a745;">
            <h4>‚úÖ –¢–µ–∫—É—â–∞—è –≥—Ä—É–ø–ø–∞:</h4>
            <p><strong>ID:</strong> 
                <span onclick="copyToClipboard('{{ current_chat_info.id }}', 'ID –≥—Ä—É–ø–ø—ã')" 
                      style="cursor: pointer; background: #f0f0f0; padding: 2px 5px; border-radius: 3px;">
                    {{ current_chat_info.id }}
                </span> üìã
            </p>
            <p><strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> {{ current_chat_info.title }}</p>
            <p><strong>–°—Ç–∞—Ç—É—Å:</strong> –ü–æ–¥–∫–ª—é—á–µ–Ω–∞</p>
            
            {% if chat_members %}
            <h4>üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã ({{ chat_members|length }}):</h4>
            <div style="max-height: 200px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; background: white;">
                {% for member in chat_members %}
                <div style="margin: 5px 0; padding: 5px; border-bottom: 1px solid #eee;">
                    <strong>{{ member.name }}</strong>
                    <span onclick="copyToClipboard('{{ member.username }}', 'Username')" 
                          style="cursor: pointer; background: #f0f0f0; padding: 2px 5px; border-radius: 3px; margin-left: 10px;">
                        {{ member.username }}
                    </span> üìã
                    <small style="color: #666;">({{ member.status }}{% if member.is_admin %} - –ê–¥–º–∏–Ω{% endif %})</small>
                </div>
                {% endfor %}
            </div>
            <small style="color: #666;">üí° –ù–∞–∂–º–∏—Ç–µ –Ω–∞ ID –∏–ª–∏ username —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</small>
            {% endif %}
        </div>
    {% endif %}
    
    <div style="background: #f0f8ff; padding: 15px; margin: 10px 0; border-left: 4px solid #007bff;">
        <h4>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ:</h4>
        <ol>
            <li>–î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É –∫–∞—Ñ–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</li>
            <li>–í –≥—Ä—É–ø–ø–µ –Ω–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É <code>/setup</code></li>
            <li>–ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç ID –≥—Ä—É–ø–ø—ã - —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ —Å—é–¥–∞:</li>
        </ol>
    </div>
    
    <form action="/update_chat_id" method="POST">
        <p>
            <label>ID —á–∞—Ç–∞ –≥—Ä—É–ø–ø—ã:</label><br>
            <input type="text" name="chat_id" placeholder="-1001234567890" value="{{ current_chat_id or '' }}" required>
            <input type="submit" value="–û–±–Ω–æ–≤–∏—Ç—å —á–∞—Ç">
        </p>
    </form>
    
    <p>
        <a href="/">‚Üê –ù–∞–∑–∞–¥ –≤ –∫–∞–±–∏–Ω–µ—Ç</a>
    </p>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ -->
    <div id="copyNotification" style="
        position: fixed; 
        top: 20px; 
        right: 20px; 
        background: #28a745; 
        color: white; 
        padding: 10px 15px; 
        border-radius: 5px; 
        display: none;
        z-index: 1000;
    ">
        ‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!
    </div>

    <script>
        function copyToClipboard(text, type) {
            navigator.clipboard.writeText(text).then(function() {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                const notification = document.getElementById('copyNotification');
                notification.textContent = `‚úÖ ${type} —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!`;
                notification.style.display = 'block';
                
                // –°–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(function() {
                    notification.style.display = 'none';
                }, 2000);
            }).catch(function() {
                alert('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è');
            });
        }
    </script>

</body>
</html>